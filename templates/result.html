<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hasil Prediksi - EMG Classifier</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="hero">
            <div class="hero-content">
                <h1>ğŸ‰ Hasil Prediksi Gestur</h1>
                <p class="hero-subtitle">
                    Model AI telah menganalisis data EMG Anda dan menghasilkan prediksi dengan confidence score.
                </p>
            </div>
        </div>

        <!-- Prediction Result -->
        <section class="prediction-result">
            <h2>ğŸ¯ Gesture Terdeteksi:</h2>
            <div class="predicted-box">
                <span class="gesture-name">{{ gesture }}</span>
            </div>
        </section>

        <!-- Confidence Scores -->
        <section class="pipeline-section">
            <h2 class="section-title">ğŸ“Š Confidence Score (Probabilitas)</h2>
            <p style="color: var(--text-light); margin-bottom: 1.5rem;">
                Model memberikan skor kepercayaan untuk setiap kelas gestur. Semakin tinggi persentase, 
                semakin yakin model dengan prediksinya.
            </p>
            
            <div class="probability-list">
                {% for class_id, class_name in gesture_map.items() %}
                <div class="prob-item">
                    <span class="prob-label">{{ class_name }}:</span>
                    
                    {% set confidence = probabilities[class_id] * 100 %}
                    <span class="prob-value">{{ confidence | round(2) }}%</span>
                    
                    <div class="prob-bar" style="width: {{ confidence | round(0) }}%;"></div>
                </div>
                {% endfor %}
            </div>
        </section>

        <!-- Input Visualization -->
        <section class="pipeline-section">
            <h2 class="section-title">ğŸ¨ Visualisasi Input Sinyal (8Ã—8 Grid)</h2>
            <p style="color: var(--text-light); margin-bottom: 1rem;">
                Heatmap di bawah menampilkan 64 nilai EMG Anda dalam format grid 8Ã—8. 
                Warna yang lebih gelap menunjukkan aktivitas otot yang lebih kuat.
            </p>
            
            <div class="emg-grid-container">
                <div class="emg-grid">
                    {% set abs_vals = input_data_64 | map('abs') | list %}
                    {% set max_val = abs_vals | max %}
                    {% set min_val = abs_vals | min %}
                    
                    {% for value in input_data_64 %}
                        {% set abs_val = value | abs %}
                        {% set scaled_opacity = (abs_val - min_val) / (max_val - min_val + 0.001) %}
                        
                        <div class="grid-cell" 
                             style="background: linear-gradient(135deg, 
                                    rgba(52, 211, 153, {{ scaled_opacity }}), 
                                    rgba(96, 165, 250, {{ scaled_opacity * 0.8 }})); 
                                    color: {% if scaled_opacity > 0.6 %}white{% else %}#1e293b{% endif %};"
                             title="Sensor Value: {{ value | round(2) }}">
                            {{ value | round(1) }}
                        </div>
                    {% endfor %}
                </div>
            </div>
            
            <p style="color: var(--text-light); text-align: center; margin-top: 1rem; font-size: 0.9rem;">
                ğŸ’¡ Hover pada setiap cell untuk melihat nilai eksak sensor
            </p>
        </section>

        <!-- Navigation -->
        <nav class="navigation-bottom">
            <a href="{{ url_for('predict') }}" class="primary">
                ğŸ”„ Coba Prediksi Lagi
            </a>
            <a href="{{ url_for('index') }}" class="secondary-button">
                ğŸ  Kembali ke Dashboard
            </a>
            <a href="{{ url_for('model_info') }}" class="secondary-button">
                ğŸ”¬ Lihat Info Model
            </a>
        </nav>
    </div>
</body>
</html>